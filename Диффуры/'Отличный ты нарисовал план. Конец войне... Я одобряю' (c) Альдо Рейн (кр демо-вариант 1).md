#диффуры 
Го разберём алгоритмы для решения номеров Кр по диффурам на примере тестового варианта 1.

## Условия
![[Pasted image 20251028124616.png]]

## Уравнение 1 (ДУ первого порядка)
### Общий подход
Есть прикольный способ решать уравнения такого вида:
1. Привести к системе линейных уравнений 
2. Сделать правильную замену
3. Привести всё к уравнению, в котором мы воспользуемся методом разделения переменных
4. Собственно воспользоваться [[Метод разделения переменных|методом разделения переменных]]
5. Интегрировать :(

### Наше уравнение
$$(17x + y + 18)dy - 2(x + 8y + 9)dx = 0$$

Начнём с представления в виде системы линейных уравнений и найдём её решение:

$$\frac{dy}{dx} = \frac{2x + 16y + 18}{17x + y + 18} \implies \begin{cases} x + 8y + 9 = 0 \\ 17x + y + 18 = 0 \end{cases}$$

Тут удобнее будет выразить $x = -8y - 9$ и подставить в первое уравнение:
$17(-8 - 9) + y + 18 = 0$
$-136y - 153 + y + 18 = 0$
$-135y = 135 \implies y = -1$
Тогда $x = 8 - 9 = -1$

Получили решение $x_0 = -1, \ y_0 = -1$

Теперь делаем замены: 
$X = x - x_0 = x + 1 \implies x = X - 1$
$Y = y - y_0 = y + 1 \implies y = Y - 1$

Подставим в начальное уравнение:

$$\frac{dy}{dx} = \frac{2(X - 1 + 8Y - 8 + 9)}{17X - 17 + Y - 1 + 18} \implies \frac{dy}{dx} = \frac{2X + 16Y}{17X + Y}$$

Теперь поделим всё на X и сделаем замену $\frac{Y}{X} = z$:
$$\frac{dy}{dx} = \frac{2 + 16 \frac{Y}{X}}{17 + \frac{Y}{X}} \implies \frac{dy}{dx} = \frac{2 + 16z}{17 + z}$$

Дальше немного преобразований:
$$Y = zX \implies \frac{dY}{dX} = z + X\frac{dz}{dX}$$
И подставим в уравнение:
$$z + X \frac{dz}{dX} = \frac{2 + 16z}{17 + z} \implies X \frac{dz}{dX} = \frac{2 - z - z^2}{17 + z}$$
И пользуемся **методом замены переменных**:
$$\frac{17 + z}{2 - z - z^2} dz = \frac{dX}{X}$$

Ну и тут уже интегрируем );
Преобразуем знаменатель: $2 - z - z^2 = -(z^2 + z - 2) = -(z + 2)(z - 1)$

Воспользуемся [[Метод нахождения неопределённых коэффициентов|методом неопределённых коэффициентов]]:
$$\frac{17 + z}{2 - z - z^2} = \frac{-A}{z + 2} + \frac{B}{z - 1}$$
$-A(z - 1) + B(z + 2) = 17 + z$
$-Az + A + Bz + 2B = 17 + z$
$\begin{cases} 2B + A = 17 \\ B - A = 1 \end{cases}$
Тогда $A = 5, \ B = 6$

И получаем, что $\frac{17 + z}{2 - z - z^2} = - \frac{5}{z + 2} + \frac{6}{z - 1}$
$-\frac{5}{z + 2} + \frac{6}{z - 1} = \frac{dX}{X}$
$-5 \ln|z + 2| + 6 \ln|z - 1| = \ln|X| + C$
$-5 \ln |\frac{Y}{X} + 2| + 6 \ln |\frac{Y}{X} - 1| = \ln|X| + C$
Итоговый ответ: 
$$-5 \ln|\frac{y + 1}{x + 1} + 2| + 6 \ln|\frac{y + 1}{x + 1} - 1| = \ln|x + 1| + C$$

## Уравнение 2 (уравнения в полных дифференциалах)
$$(t + 2 y e^{\sqrt{y}})dy - (2y)dt = 0$$
Вот тут мы зашли на территорию дядюшки Эйлера ([фото для вдохновения](https://bb.edu.gov.kg/images/d/d7/Портреты_ученых_Эйлер.jpg))

### Общий подход

В общем виде такие уравнения записываются как:
$$M(x, y)dx + N(x, y)dy = 0$$

Чтобы ДУ такого вида называлось уравнением **в полных дифференциалах** (то есть существовала некая функция $U(x, y)$, для которой выполняется: $M = \frac{dU}{dx}, \ N = \frac{dU}{dy}$), необходимо выполнение **условия Эйлера**.

Условие Эйлера гласит:
$$F_{Eu} = \frac{dM}{dy} - \frac{dN}{dx} = 0$$

1. При выполнении условия Эйлера существует функция $U(x, y)$ такая, что $dU = Mdx + Ndy = 0$ и решение находится интегрированием одной части (например, M) и подстановкой результата во вторую часть (например, в N).
2. При невыполнении условия нам придётся искать **интегрирующий множитель** $\mu(x, y)$, который поможет привести наше уравнение к уравнению в полных дифференциалах: $\mu M dx + \mu N dy = 0$.

Как искать интегрирующий множитель $\mu$? Вообще $\mu (x, y)$ - функция от двух переменных, но зачастую в уравнениях такого вида можно подобрать $\mu$ от одной переменной. Сейчас посмотрим, как проверить, какую из переменных брать.

Попробуем искать $\mu(x)$, тогда наше уравнение имеет вид (если не интересно, можно скипнуть до появления $F_1$): $$\mu(x) \cdot M(x, y)dx + \mu(x) \cdot N(x, y)dy = 0$$
Тогда обновлённое условие Эйлера будет выглядеть так:
$$\frac{d}{dy} \mu(x) \cdot M(x, y) - \frac{d}{dx} \mu(x) \cdot N(x, y) = 0$$
Дифференцируем и получим:
$$\frac{d \mu(x)}{dx} \cdot N(x, y) - \mu(x) (\frac{d}{dy} M(x, y) - \frac{d}{dx} N(x, y)) = 0$$
Из чего следует:
$$\frac{d \ln(\mu(x))}{dx} - \frac{1}{N(x, y)}F_{Eu}(x, y) = 0$$
Но это уравнение будет дифференциальным только в том случае, если функция: 
$$F_1(x, y) = \frac{F_{Eu}(x, y)}{N(x, y)} = \frac{\frac{dM}{dy} - \frac{dN}{dx}}{N}$$
**не будет зависеть от переменной y**

Если это выполняется, то $\mu(x)$ можно найти так:
$$\mu(x) = \exp(\int F_1(x) dx)$$

Аналогично, если хотим найти интегрирующий множитель $\mu(y)$, то:
1. Ищем $F_2(x, y) = - \frac{F_{Eu}(x, y)}{M(x, y)} = - \frac{\frac{dM}{dy} - \frac{dN}{dx}}{M}$
2. Проверяем, что $F_2(x, y)$ не зависит от x
3. Ищем $\mu(y) = \exp(\int F_2(y) dy)$

Ну а дальше суём $\mu$ в исходное уравнение и решаем его.

Простыми словами: 
- Если $\frac{dM}{dy} = \frac{dN}{dx}$, то $M = \frac{dU}{dx}, \ N = \frac{dU}{dy}$ и мы уже можем с кайфиком интегрировать
- Если нет, то чекаем, что $\frac{\frac{dM}{dy} - \frac{dN}{dx}}{N}$ не зависит от x или $- \frac{\frac{dM}{dy} - \frac{dN}{dx}}{M}$ не зависит от y и находим $\mu = \exp(\int F_{1/2} d(x/y))$, затем подставляем в уравнение

### Наше уравнение
Всё, газанём с нашим уравнением:
$$(t + 2 y e^{\sqrt{y}})dy - (2y)dt = 0$$
Смотрим на общий вид ($M(x, y)dx + N(x, y)dy = 0$) и понимаем, что в нашем случае 
- $M = -2y \implies \frac{dM}{dy} = -2$
- $N = t + 2y^{\sqrt{y}} \implies \frac{dN}{dt} = 1$
$\frac{dM}{dy} \neq \frac{dN}{dt}$, значит надо искать интегрирующий множитель.

Есть наитие, что надо искать множитель от y, то есть
$- \frac{\frac{dM}{dy} - \frac{dN}{dt}}{M}$ должно **не зависеть от t** .
$$- \frac{\frac{dM}{dy} - \frac{dN}{dt}}{M} = - \frac{-2 - 1}{-2y} = - \frac{3}{2y}$$ - не зависит от t. 

Всё супер, тогда ищем $\mu(y)$:
$\mu(y) = \exp(\int(F_2 dy)) = \exp(- \frac{3}{2} \int(\frac{dy}{y})) \implies \mu(y) = e^{- \frac{3}{2} \ln |y| + C} \implies \mu(y) = y^{-\frac{3}{2}}$

Подставляем $\mu$ в уравнение:
$$y^{-\frac{3}{2}} \cdot ((t + 2 y e^{\sqrt{y}})dy - (2y)dt) = 0$$
$$-2y^{-\frac{1}{2}}dt + (ty^{-\frac{3}{2}} + 2y^{-\frac{1}{2}}e^{\sqrt{y}})dy = 0$$
Теперь рассматриваем это уравнение, вспоминая общий вид, и понимаем, что:
- $\tilde{M} = -2y^{-\frac{1}{2}}$
- $\tilde{N} = ty^{-\frac{3}{2}} + 2y^{-\frac{1}{2}}e^{\sqrt{y}}$

Проверяем условие Эйлера: 
- $\frac{d\tilde{M}}{dy} = -2 \cdot (-\frac{1}{2})y^{-\frac{3}{2}} = y^{-\frac{3}{2}}$
- $\frac{d\tilde{N}}{dt} = y^{-\frac{3}{2}}$
- $\frac{d\tilde{M}}{dy} = \frac{d\tilde{N}}{dt}$ - победа

Теперь ищем $U(t, y)$ такую что $dU = 0$.
- $\tilde{M} = \frac{dU}{dt} = -2y^{-\frac{1}{2}}$
- $\tilde{N} = \frac{dU}{dy} = ty^{-\frac{3}{2}} + 2y^{-\frac{1}{2}}e^{\sqrt{y}}$

1. Интегрируем $\tilde{M}$ по $t$ и получим:
	$U(t, y) = \int -2y^{-\frac{1}{2}}dt = -2ty^{-\frac{1}{2}} + u(y)$
	($u(y)$ - это как бы константа, которая на самом деле может зависеть от y, потому что мы интегрировали только по t)
2. То, что получилось, дифференцируем по y:
	$\tilde{N} = \frac{dU}{dy} = -2t \cdot (-\frac{1}{2}) y^{-\frac{3}{2}} + u'(y) = ty^{-\frac{3}{2}} + u'(y)$
3. Сравниваем с найденным до этого $\tilde{N}$:
	$\tilde{N} = ty^{-\frac{3}{2}} + u'(y) = ty^{-\frac{3}{2}} + 2y^{-\frac{1}{2}}e^{\sqrt{y}} \implies u'(y) = 2y^{-\frac{1}{2}} e^{\sqrt{y}}$
4. Интегрируем:
	$u'(y) = 2y^{-\frac{1}{2}} e^{\sqrt{y}} \implies u(y) = \int 2y^{-\frac{1}{2}} e^{\sqrt{y}}$
	Тут какой-то флекс начинается:
	Пусть $k = y^{\frac{1}{2}}$, тогда $y = k^2, \ dy = 2k dk, \ y^{-\frac{1}{2}} = \frac{1}{k}$, тогда получим:
	$$u(y) = \int 2 \cdot \frac{1}{k} \cdot e^{k} \cdot 2k dk = 4 \int e^k dk = 4e^k + C = 4e^{\sqrt{y}} + C$$
Подставляем всё в $U(t, y)$ и получаем общий интеграл:
$$U(t, y) = -2ty^{-\frac{1}{2}} + 4e^{\sqrt{y}} + C$$
**Общее решение:**
$$4e^{\sqrt{y}} - \frac{2t}{\sqrt{y}} = C$$

## Уравнение 3 (капитанский колл)
$$(\sin x + \frac{y}{x^2} \cdot \sin y)dx + (\frac{1}{y} \cdot \cos x - \frac{y}{x} \cdot \cos y)dy = 0$$
В 3 номере могут быть уравнения разного вида. Конкретно тут был капитанский колл от Виктора Михайловича, гласящий, что нужно решать через полные дифференциалы (как до этого делали).

У нас тут будет:
$M = \sin x + \frac{y}{x^2} \sin y$
$N = \frac{1}{y} \cos x - \frac{y}{x} \cos y$

Проверяем условие Эйлера:
- $\frac{dM}{dy} = \frac{1}{x^2} \sin y + \frac{y}{x^2} \cos y = \frac{\sin y + y \cos y}{x^2}$
- $\frac{dN}{dx} = - \frac{1}{y} \sin x + \frac{y}{x^2} \cos y$
- $\frac{dM}{dy} \neq \frac{dN}{dx}$

Теперь найдём интегрирующий множитель $\mu$, зависящий от y. Проверяем, что вот эта функция не зависит от x:
$$\frac{\frac{dN}{dx} - \frac{dM}{dy}}{M} = \frac{- \frac{1}{y} \sin x + \frac{y}{x^2} \cos y - \frac{\sin y + y \cos y}{x^2}}{\sin x + \frac{y}{x^2} \sin y} = \frac{- \frac{1}{y} \sin x - \frac{\sin y}{x^2}}{\sin x + \frac{y}{x^2} \sin y} = \frac{- \frac{x^2}{y} \sin x - \sin y}{x^2 \sin x + y \sin y} =$$
$$= \frac{- \frac{1}{y}(x^2 \sin x + y \sin y)}{x^2 \sin x + y \sin y} = -\frac{1}{y}$$
Эта функция не зависит от y, значит $\mu = \exp (\int F_2 dy)$
$$\mu = \exp (\int F_2 dy) = \exp(\int - \frac{1}{y} dy) = \exp(- \ln|y| + C) = \frac{1}{y}$$

Теперь подставляем $\mu$ в исходное уравнение:
$$\frac{1}{y}\left((\sin x + (\frac{y}{x^2}) \cdot \sin y)dx + (\frac{1}{y} \cdot \cos x - \frac{y}{x} \cdot \cos y)dy \right) = 0$$
$$(\frac{\sin x}{y} + \frac{\sin y}{x^2})dx + (\frac{\cos x}{y^2} - \frac{\cos y}{x})dy = 0$$

Получаем:
- $\tilde{M} = \frac{\sin x}{y} + \frac{\sin y}{x^2}$
- $\tilde{N} = \frac{\cos x}{y^2} - \frac{\cos y}{x}$

Проверяем условие Эйлера:
- $\frac{d\tilde{M}}{dy} = - \frac{\sin x}{y^2} + \frac{\cos y}{x^2}$
- $\frac{d\tilde{N}}{dx} = - \frac{\sin x}{y^2} + \frac{\cos y}{x^2}$
- $\frac{dM}{dy} = \frac{dN}{dx}$ - победа

Теперь ищем $U(x, y)$ такую что $dU = 0$.
- $\tilde{M} = \frac{\sin x}{y} + \frac{\sin y}{x^2} = \frac{dU}{dx}$
- $\tilde{N} = \frac{\cos x}{y^2} - \frac{\cos y}{x} = \frac{dU}{dy}$

1. Интегрируем $\tilde{M}$ по x:
	$U(x, y) = \int \tilde{M} dx = \int (\frac{\sin x}{y} + \frac{\sin y}{x^2})dx = - \frac{\cos x}{y} - \frac{\sin y}{x} + u(y)$
2. То, что получилось, дифференцируем по y:
	$\frac{dU}{dy} = \frac{\cos x}{y^2} - \frac{\cos y}{x} + u'(y)$
3. Сравниваем это с найденным до этого $\tilde{N}$:
	$\tilde{N} = \frac{\cos x}{y^2} - \frac{\cos y}{x} = \frac{\cos x}{y^2} - \frac{\cos y}{x} + u'(y)$
4. Получаем:
	$u'(y) = 0 \implies u(y) = C$

Подставляем в $U(x, y)$ и получаем общий интеграл:
$$U(x, y) = - \frac{\cos x}{y} - \frac{\sin y}{x} + C$$
**Общее решение:**
$$\frac{\cos x}{y} + \frac{\sin y}{x} = C$$

## Уравнение 4 (линейное неоднородное ДУ порядка > 1)
### Общий подход
Это [[Линейное ДУ второго+ порядка|линейное неоднородное дифференциальное уравнение второго порядка]]. Слева у нас стоит какое-то уравнение, а справа функция от независимой переменной.

Как решать?

На лекциях Виктор Михалыч рассказывал, что линейное однородное уравнение с постоянными коэффициентами имеет вид:
$$u^{(n)} + a_{n - 1} \cdot u^{(n - 1)} + \dots + a_0 \cdot u$$
Решением такого уравнения будет функция $u(t) = C \cdot \exp(\lambda \cdot t)$, но только если величина $\lambda$ удовлетворяет уравнению:
$$\lambda^n + a_{n - 1} \cdot \lambda^{n - 1} + a_{n - 2} \cdot \lambda^{n - 2} + \dots + a_1 \cdot \lambda + a_0 = 0$$
Это уравнение называют характеристическим.

Выписываем такое характеристическое уравнение для нашего ДУ, находим корни $\lambda_1, \ \lambda_2$ и ищем общее решение:
- Если корни действительны и различны, то:
	$u(t) = C_1 e^{\lambda_1 t} + C_2 e^{\lambda_2 t}$
- Если корень кратный ($\lambda_1 = \lambda_2$):
	$u(t) = C_1 e^{\lambda_1 t} + C_2 te^{\lambda_1 t}$
- Если корни комплексные:
	$u(t) = e^{\alpha t} (C_1 \cos \beta t + C_2 \sin \beta t)$

Далее ищем частное решение исходного уравнения в зависимости от правой части. У Виктора Михалыча была небольшая табличка:
![[Pasted image 20251102002454.png]]

В инете нашёл что-то такое (более общее). Хз, что лучше использовать:
![[Pasted image 20251106003356.png]]

В общем, в этом и всё решение
(Забыл сказать, что общее и частное решение мы обозначаем как $u(t)$ и $w(t)$)

### Наше уравнение
Всё, газанём с нашим уравнением:
$$\ddot{y} + 7\dot{y} + 12y = t^4 + \exp(-4t)$$
Характеристическое уравнение для нашего уравнения:
$$\lambda^2 + 7 \lambda + 12 = 0$$
Дискриминантом мозги особо не делаем, по Виета будет $\lambda_1 = -3, \ \lambda_2 = -4$

Корни действительные и разные, поэтому:
$$u(t) = C_1 e^{-3t} + C_2 e^{-4t}$$
Дальше ищем частные решения.
Правая часть у нас $f(t) = t^4 + e^{-4t}$, ищем частное решение в виде суммы $w(t) = w_1(t) + w_2(t)$, то есть:
- $\ddot{w}_1 + 7\dot{w}_1 + 12 w_1 = t^4$
- $\ddot{w}_2 + 7\dot{w}_2 + 12 w_2 = e^{-4t}$

Теперь отдельно найдём частные решение $w_1(t)$ и $w_2(t)$. Сначала $w_1(t)$:
$t^4$ - полином 4-й степени, поэтому частное решение будет иметь вид:
$w_1(t) = A_4t^4 + A_3t^3 + A_2t^2 + A_1t + A_0$
$\dot{w}_1 = 4A_4t^3 + 3A_3t^2 + 2A_2t + A_1$
$\ddot{w}_1 = 12A_4t^2 + 6A_3t + 2A_2$

Подставляем в уравнение $\ddot{w}_1 + 7\dot{w}_1 + 12 w_1 = t^4$ и подбираем коэффициенты:
Получили $12A_4t^2 + 6A_3t + 2A_2 + 28A_4t^3 + 21A_3t^2 + 14A_2t + 7A_1 + 12A_4t^4 + 12A_3t^3 + 12A_2t^2 + 12A_1t + 12A_0 =$
$= 12A_4t^4 + 28A_4t^3 + 12A_3t^3 + 12A_4t^2 + 21A_3t^2 + 12A_2t^2 + 6A_3t + 14A_2t + 12A_1t + 2A_2 + 7A_1 + 12A_0 = t^4$
- Для $t^4$: $12 A_4 = 1 \implies A_4 = \frac{1}{12}$
- Для $t^3$: $28A_4 + 12A_3 \implies 28 \cdot \frac{1}{12} + 12 A_3 = 0 \implies A_3 = - \frac{7}{36}$
- Для $t^2$: $12A_4 + 21A_3 + 12A_2 = 0 \implies - \frac{111}{36} + 12A_2 = 0 \implies A_2 = \frac{37}{144}$
- Для $t$: $6A_3 + 14A_2 + 12A_1 = 0 \implies - \frac{7}{6} + \frac{518}{144} + 12A_1 = 0 \implies \frac{350}{144} + 12A_1 = 0 \implies A_1 = - \frac{175}{864}$
- Свободные коэффициенты: $2A_2 + 7A_1 + 12A_0 = 0 \implies \frac{74}{144} - \frac{1225}{864} + 12A_0 = 0 \implies -\frac{781}{864} + 12A_0 = 0 \implies A_0 = \frac{781}{10368}$
В итоге получим:
$$w_1(t) = \frac{1}{12}t^4 - \frac{7}{36}t^3 + \frac{37}{144}t^2 - \frac{175}{864}t + \frac{781}{10368}$$

Теперь частное решение $w_2(t)$:
Правая часть $e^{-4t}$, "-4" - это корень степени 1 характеристического уравнения, значит нам из таблички подходит вариант $w_2(t) = t \cdot e^{-4t} \cdot Q$

Вычисляем производные:
$\dot{w}_2 = Q(e^{-4t} - 4te^{-4t}) = Q(1 - 4t)e^{-4t}$
$\ddot{w}_2 = Q(-4e^{-4t} - 4e^{-4t} + 16te^{-4t}) = Q(-8 + 16t)e^{-4t}$

Теперь подставим в уравнение:
$\ddot{w}_2 + 7\dot{w}_2 + 12w_2 = e^{-4t}$
$Q((-8 + 16t) + 7(1 - 4t) + 12t)e^{-4t} = e^{-4t}$
$Q(-8 + 16t + 7 - 28t + 12t) = 1$
$Q = -1$
Тогда $w_2(t) = -t^{-4t}$

**В итоге** решение находится как $y(t) = u(t) + w_1(t) + w_2(t)$:
$$y(t) = C_1 e^{-3t} + C_2 e^{-4t} + \frac{1}{12} t^4 - \frac{7}{36}t^3 + \frac{37}{144}t^2 - \frac{175}{864}t + \frac{781}{10368} - te^{-4t}$$