#алгебра 
1) Получатель (Алиса) выбирает
	- большие простые числа p и q, $p \neq q$
	- вычисляет $n = pq$
	- вычисляет $\varphi(n) = (p - 1)(q - 1)$
	- выбирает число e из $\mathbb{Z}_{\varphi(n)}^*$:
		$1 < e < \varphi(n)$
	- находит $d: \ d \cdot e = 1 (mod \ \varphi(n))$ по [[Расширенный Алгоритм Евклида|расширенному алгоритму Евклида]]
2) Получатель (Алиса) забывает все числа, кроме n и d. 
	- $(n, d)$ - **закрытый ключ шифрования**. Его надо держать в секрете
	- $(n e)$ - **открытый ключ**, он публикуется
3) Отправитель (Боб) хочет отправить число $m \in \mathbb{Z}_n$
	Если:
	- $НОД(m, n) \neq 1 \implies$ нам известно либо p, либо q $\implies$ знаем $n = p \cdot q$ - факторизация
		Посчитаем вероятность такого события:
		$P \{ (m, n) \neq 1 \} = 1 - \frac{\varphi(n)}{n} = 1 - \frac{(p - 1)(q - 1)}{n} = 1 - 1 + \frac{1}{p} + \frac{1}{q} - \frac{1}{n} \approx \frac{2}{\sqrt{n}} \approx 2^{-256} \approx 10^{-78}$ - для двоичных чисел длиной 256 бит
		Вероятность такого события ничтожно мала, поэтому мы её не учитываем и выбираем m случайно
4) Боб вычисляет $m_{1} = m^e(mod \ n)$ и передаёт Алёне
5) Алиса вычисляет $m_2 = m_1^d(mod \ n) = m???$
	Рассматриваем всё в $\mathbb{Z}_n$
	$m_2 = m_1^d = (m^e)^d = m^{e \cdot d}$
	$e \cdot d = 1 + \varphi(n) \cdot k$
	Тогда $m^{e \cdot d} = m^{1 + \varphi(n) \cdot k} = m \cdot (m^{\varphi(n)})^k = m \cdot 1^{(\mathbb{Z}_n)^k} = m (mod \ n)$
	То есть, Алиса расшифровывает сообщение правильно, если $НОД(m, n) = 1$

## Стойкость схемы
$n = p \cdot q$
$\varphi(n) = n - (p + q) + 1$
$x^2 - (n - \varphi(n) + 1)x + n = 0$