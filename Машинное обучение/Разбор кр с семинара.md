#машинка 
## Замечания
- Пишем на бумажках
- Нельзя пользоваться электронными устройствами (шаббат)
- Можно пользоваться бумажными шпорами и записями

## Задания и темы
### 1. Линейная регрессия
Пример: 
	$a(x) = w_0 + w_1x_1$ - имеем один параметр
	Если есть регуляризация, то записываем:
	- $L_1 = |w_1|$
	- $L_2 = w_1^2$
	Если регуляризация, то:
		$Q = \sum\limits_{i = 1}^{N}(y_i - a(x_i))^2 + \alpha|w_1|$
	"И это будет самая простая задача" (С) Вальба Ольга Владимировна
### 2. Логистическая регрессия ("непростая задача, но может сделаем попроще, а может нет") 
Здесь решим задачу из кр, а в самой кр сделаем задачу попроще.
#### Условие:
Винни-Пух знает, что мёд (метка класса) бывает правильный и неправильный. То есть, y бывает 1 и -1. Мёд дают пчёлы (признаки). Они тоже бывают правильными и неправильными. Винни-Пух сделал 100 наблюдений и составил таблицу:	

| $x_1$     | $y = 1$ | $y = -1$ |
| --------- | ------- | -------- |
| $x_1 = 1$ | 12      | 36       |
| $x_1 = 0$ | 32      | 20       |

Винни-Пух использует log регрессию, чтобы определить правильность мёда. Какие коэффициенты он получит в регрессии и какими будут вероятности соответствующих событий?

#### Решение:
$a(x) = w_0 + w_1x_1$ - так как признак всего один
$Q(a) = \sum\limits_{i = 1}^{N} \log_2(1 + e^{-M_i})$, где $M_i = y_i(w_0 + w_1x_{i_{1}}$
Считаем вероятности (например, для правильных пчёл)
$P(y = 1 \ (x_1)) = \frac{12}{48}$
$P(y = -1 \ (x_1)) = \frac{36}{48}$

Есть формула, которая связывает скалярное произведение и вероятности:
$(w, x) = \log_2 \frac{P(y = 1 \ (x))}{P(y = -1 \ (x))}$

Считаем коэффициенты:
Для правильных пчёл: $w_0 + w_1 \approx \log_2 \frac{1}{3}$
Для неправильных пчёл: $w_0 \approx \log_2 \frac{8}{5}$

### 3. Метрики качества
#### Условие
Винни-Пух построил бинарный классификатор. Известна доля верных предсказаний $Acc = A$, полнота $Re = 1$ и точность $Pr = B$. Надо найти соотношение классов $\frac{N^+}{N^-}$.

#### Решение
$Acc = \frac{TP + TN}{TP + TN + FP + FN} = \frac{TP + TN}{N^+ + N^-}$
$Re = \frac{TP}{TP + FN} = \frac{TP}{N^+}$
$Pr = \frac{TP}{TP + FP}$

$Re = 1 \implies FN = 0, \ TP = N^+ \implies Acc = \frac{N^+ + TN}{N^+ + N^-}$
$Pr = B = \frac{N^+}{N^+ + FP} \implies FN = \frac{N^+}{B} - N^+$
$FP + TN = N^- \implies TN = N^- - \frac{N^+}{B} + N^+$
$$A = \frac{TP + TN}{N^+ + N^-} = \frac{N^+ + TN}{N^+ + N^-} = \frac{2N^+ + N^- - \frac{N^+}{B}}{N^+ + N^-} = \frac{2 + (\frac{N^-}{N^+}) - \frac{1}{B}}{1 + \frac{N^-}{N^+}}$$
Возьмём $t = \frac{N^-}{N^+}$
$A + tA = 2 + t - \frac{1}{B}$
$tA - t = 2 - \frac{1}{B} - A$
$t(A - 1) = 2 - \frac{1}{B} - A$

### 4. ROC-кривая
В домашке у нас было конечное число точек, мы просто их классифицировали и соединяли:
![[Pasted image 20251129115854.png|300]]

В кр нам надо будет решать что-то "более интегральное". Например, дана плотность распределения положительных объектов в зависимости от функции a:
![[Pasted image 20251129120213.png|400]]

ROC-кривая строится от какого-то порога. Возьмём порог t и начнём "двигать его вниз".
Нас интересует, чему равно $TP(t) = \int\limits_{t}^{N} \rho(a) da$ - объекты, вероятность которых выше порога

"Дальше подсказывать не буду, но вот это вам пригодится"

### 5. На ядра
$x, y \in R^d$ Есть ядерная функция: $K(x, y)$
Мы меняем скалярное произведение на эту функцию: $(x, y) \to K(x, y)$
Надо найти длину вектора и косинус угла между ними в исходном и в новом пространстве.
$|x| = \sqrt{x_1^2 + x_2^2 + \dots + x_d^2}$
$|y| = \dots$
$\cos \varphi = \frac{(x, y)}{|x| \cdot |y|}$


Тогда длину вектора в новом пространстве определяем так:
$\sqrt{K(x, x)}$

### 6. Деревья решений
"Будет что-то простое на уровне "посчитать энтропию" или вообще не будет"

### 7. Разложение ошибок


### 8. Разложение ошибок. Бутстрап
Пусть есть $\{ x_i \}_1^N$
Хотим сделать несколько выборок, полученных из разных подвыборок.

Берём кусок размера K:
$x' = \{ x_i \}_1^K$
Вытягиваем с повторением K элементов из N
Вот такое вытягивание и называется **бутстрапом**

#### Условие
У Винни-Пуха есть 100 песенок. Каждый день он наугад выбирает и поёт песню.
Сколько в среднем песенок оказываются неспетыми за 100 дней?

#### Решение:
$P = (1 - \frac{1}{N})^N$ - полная вероятность того, что песенка не спета
$E(N) \approx NP$